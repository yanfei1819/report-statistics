## 计算发车时间的数据而插入到汇总表中
tms.report.statistics.send-date=SELECT h.applyDate,h.projectId,h.sendCity,h.arriveCity,h.carType,h.partnerNo,SUM(h.feeAmt) totalTransportCash,SUM(h.income) totalIncome,COUNT(h.id) totalCarNumber,COUNT(DISTINCT CASE WHEN h.carLength  = '4.2' THEN h.id END) AS length42CarNumber,COUNT(DISTINCT CASE WHEN h.carLength  = '6.8' THEN h.id END) AS length68CarNumber,COUNT(DISTINCT CASE WHEN h.carLength  = '7.6' THEN h.id END) AS length76CarNumber,COUNT(DISTINCT CASE WHEN h.carLength  = '9.6' THEN h.id END) AS length96CarNumber,COUNT(DISTINCT CASE WHEN h.carLength  = '12.5' THEN h.id END) AS length125CarNumber,COUNT(DISTINCT CASE WHEN h.carLength  = '13.0' THEN h.id END) AS length130CarNumber,COUNT(DISTINCT CASE WHEN h.carLength  = '15.0' THEN h.id END) AS length150CarNumber,COUNT(DISTINCT CASE WHEN h.carLength  = '16.0' THEN h.id END) AS length160CarNumber,COUNT(DISTINCT CASE WHEN h.carLength  = '17.5' THEN h.id END) AS length175CarNumber,COUNT(DISTINCT CASE WHEN h.carLength  = '21.0' THEN h.id END) AS length210CarNumber,COUNT(DISTINCT CASE WHEN h.carLength IS NULL OR h.carLength NOT IN('4.2','6.8','7.6','9.6','12.5','13.0','15.0','16.0','17.5','21.0') THEN h.id END) AS lengthOtherCarNumber,SUM(CASE WHEN h.carLength  = '4.2' THEN h.income ELSE 0 END) AS length42Income,SUM(CASE WHEN h.carLength  = '6.8' THEN h.income ELSE 0 END) AS length68Income,SUM(CASE WHEN h.carLength  = '7.6' THEN h.income ELSE 0 END) AS length76Income,SUM(CASE WHEN h.carLength  = '9.6' THEN h.income ELSE 0 END) AS length96Income,SUM(CASE WHEN h.carLength  = '12.5' THEN h.income ELSE 0 END) AS length125Income,SUM(CASE WHEN h.carLength  = '13.0' THEN h.income ELSE 0 END) AS length130Income,SUM(CASE WHEN h.carLength  = '15.0' THEN h.income ELSE 0 END) AS length150Income,SUM(CASE WHEN h.carLength  = '16.0' THEN h.income ELSE 0 END) AS length160Income,SUM(CASE WHEN h.carLength  = '17.5' THEN h.income ELSE 0 END) AS length175Income,SUM(CASE WHEN h.carLength  = '21.0' THEN h.income ELSE 0 END) AS length210Income,SUM(CASE WHEN h.carLength IS NULL OR h.carLength NOT IN('4.2','6.8','7.6','9.6','12.5','13.0','15.0','16.0','17.5','21.0') THEN h.income ELSE 0 END) AS lengthOtherIncome,SUM(CASE WHEN h.carLength  = '4.2' THEN h.feeAmt ELSE 0 END) AS length42TransportCash,SUM(CASE WHEN h.carLength  = '6.8' THEN h.feeAmt ELSE 0 END) AS length68TransportCash,SUM(CASE WHEN h.carLength  = '7.6' THEN h.feeAmt ELSE 0 END) AS length76TransportCash,SUM(CASE WHEN h.carLength  = '9.6' THEN h.feeAmt ELSE 0 END) AS length96TransportCash,SUM(CASE WHEN h.carLength  = '12.5' THEN h.feeAmt ELSE 0 END) AS length125TransportCash,SUM(CASE WHEN h.carLength  = '13.0' THEN h.feeAmt ELSE 0 END) AS length130TransportCash,SUM(CASE WHEN h.carLength  = '15.0' THEN h.feeAmt ELSE 0 END) AS length150TransportCash,SUM(CASE WHEN h.carLength  = '16.0' THEN h.feeAmt ELSE 0 END) AS length160TransportCash,SUM(CASE WHEN h.carLength  = '17.5' THEN h.feeAmt ELSE 0 END) AS length175TransportCash,SUM(CASE WHEN h.carLength  = '21.0' THEN h.feeAmt ELSE 0 END) AS length210TransportCash,SUM(CASE WHEN h.carLength IS NULL OR h.carLength NOT IN('4.2','6.8','7.6','9.6','12.5','13.0','15.0','16.0','17.5','21.0') THEN h.feeAmt ELSE 0 END) AS lengthOtherTransportCash,COUNT(DISTINCT CASE WHEN h.warnType = 1 THEN h.id END) lateWarningCars FROM YD_APP_TRANSPORTCASH h WHERE h.applyDate = ? AND h.delStatus = 0 AND billStatus <> 'Q' and transStatus <> 'D' GROUP BY h.applyDate,h.projectId,h.sendCity,h.arriveCity,h.carType,h.partnerNo LIMIT ?,?

## 利润报表统计的查询sql
tms.report.statistics.profit-query=SELECT h.tmsBillCode,l.upWayBillId,h.sendCity,h.arriveCity,h.carType,h.projectid projectId,DATE_FORMAT(h.applyDate,'%Y-%m-%d') sendDate,h.income,h.feeAmt totalFreight,h.carLength,h.carModel,h.partnerNo,g.kilometers,g.oilCost,g.roadCost,g.repairCost,g.depreciationCost,g.insurance,g.personCost,g.taxRate,g.otherCost,g.infoCost,g.sendProvince,g.sendDistrict,g.arriveProvince,g.arriveDistrict,g.stationAProvince,g.stationACity,g.stationADistrict,g.stationBProvince,g.stationBCity,g.stationBDistrict FROM YD_APP_TRANSPORTCASH h INNER JOIN YD_APP_ORDER_TRANSPORT t ON h.id = t.wayBillId INNER JOIN YD_TMS_INCOME_COST_CONFIG g ON h.carType = g.carType AND h.carLength = g.carLength AND h.carModel = g.carModel AND ((h.projectid = g.projectId AND g.projectId <> 0) OR g.projectId = 0) AND h.sendCity = g.sendCity AND h.arriveCity = g.arriveCity AND h.sendProvince = g.sendProvince AND h.arriveProvince = g.arriveProvince AND h.sendDistrict = g.sendDistrict AND h.arriveDistrict = g.arriveDistrict LEFT JOIN YD_TMS_APP_TRANSPORTCASH_DETAIL l ON l.wayBillId = h.id AND g.stationAProvince = l.stationAProvince AND g.stationACity = l.stationACity AND g.stationADistrict = l.stationADistrict AND g.stationBProvince = l.stationBProvince AND g.stationBCity = l.stationBCity AND g.stationBDistrict = l.stationBDistrict WHERE h.delStatus = 0 AND t.node = ? AND t.`status` = ? AND DATE_FORMAT(t.createTime,'%Y-%m-%d') = ? LIMIT ?,?